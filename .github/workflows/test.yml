name: Get Latest Release

on:
  workflow_run:
    workflows: ["your_workflow_name"]
    types:
      - completed
  push:

jobs:
  get-latest-release:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '14'

    - name: Install dependencies
      run: npm install @actions/github

    - name: Get Latest Release
      uses: actions/github-script@v6
      with:
        script: |
          const { GitHub, context: githubContext } = require('@actions/github');
          const octokit = new GitHub(process.env.GITHUB_TOKEN);
  
          const { owner, repo } = context.repo;
  
          // Make a request to the GitHub Releases API
          const latestRelease = await octokit.repos.getLatestRelease({ owner, repo });
          const latestReleaseTag = latestRelease.data.tag_name;
  
          // Set the output variable for later use
          console.log(`::set-output name=latest_release::${latestReleaseTag}`);

    - name: Use Latest Release
      run: |
        # Use the latest release tag in subsequent steps
        echo "Latest release: ${{ steps.get-latest-release.outputs.latest_release }}"
